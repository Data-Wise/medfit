% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/aab-generics.R, R/bootstrap.R
\name{bootstrap_mediation}
\alias{bootstrap_mediation}
\title{Perform Bootstrap Inference for Mediation Statistics}
\usage{
bootstrap_mediation(
  statistic_fn,
  method = c("parametric", "nonparametric", "plugin"),
  mediation_data = NULL,
  data = NULL,
  n_boot = 1000L,
  ci_level = 0.95,
  parallel = FALSE,
  ncores = NULL,
  seed = NULL,
  ...
)

bootstrap_mediation(
  statistic_fn,
  method = c("parametric", "nonparametric", "plugin"),
  mediation_data = NULL,
  data = NULL,
  n_boot = 1000L,
  ci_level = 0.95,
  parallel = FALSE,
  ncores = NULL,
  seed = NULL,
  ...
)
}
\arguments{
\item{statistic_fn}{Function that computes the statistic of interest.
\itemize{
\item For parametric bootstrap: receives named parameter vector, returns scalar
\item For nonparametric bootstrap: receives data frame, returns scalar
\item For plugin: receives named parameter vector, returns scalar
}}

\item{method}{Character string: bootstrap method. Options:
\itemize{
\item \code{"parametric"}: Sample from multivariate normal (fast, assumes normality)
\item \code{"nonparametric"}: Resample data and refit (robust, slower)
\item \code{"plugin"}: Point estimate only, no CI (fastest)
}}

\item{mediation_data}{\link{MediationData} object (required for parametric/plugin)}

\item{data}{Data frame (required for nonparametric bootstrap)}

\item{n_boot}{Integer: number of bootstrap samples (default: 1000)}

\item{ci_level}{Numeric: confidence level between 0 and 1 (default: 0.95)}

\item{parallel}{Logical: use parallel processing? (default: FALSE)}

\item{ncores}{Integer: number of cores for parallel processing.
If NULL, uses \code{parallel::detectCores() - 1}}

\item{seed}{Integer: random seed for reproducibility (optional but recommended)}

\item{...}{Additional arguments (reserved for future use)}
}
\value{
A \link{BootstrapResult} object containing:
\itemize{
\item Point estimate
\item Confidence interval bounds
\item Bootstrap distribution (for parametric and nonparametric)
\item Method used
}

A \link{BootstrapResult} object containing:
\itemize{
\item Point estimate
\item Confidence interval bounds
\item Bootstrap distribution (for parametric and nonparametric)
\item Method used
}
}
\description{
Conduct bootstrap inference to compute confidence intervals for
mediation statistics. Supports parametric, nonparametric, and
plugin methods.

Conduct bootstrap inference to compute confidence intervals for
mediation statistics. Supports parametric, nonparametric, and
plugin methods.
}
\details{
\subsection{Bootstrap Methods}{

\strong{Parametric Bootstrap} (\code{method = "parametric"}):
\itemize{
\item Samples parameter vectors from \eqn{N(\hat{\theta}, \hat{\Sigma})}{N(theta-hat, Sigma-hat)}
\item Fast and efficient
\item Assumes asymptotic normality of parameters
\item Recommended for most applications with n > 50
}

\strong{Nonparametric Bootstrap} (\code{method = "nonparametric"}):
\itemize{
\item Resamples observations with replacement
\item Refits models for each bootstrap sample
\item More robust, no normality assumption
\item Computationally intensive
\item Use when normality is questionable or n is small
}

\strong{Plugin Estimator} (\code{method = "plugin"}):
\itemize{
\item Computes point estimate only
\item No confidence interval
\item Fastest method
\item Use for quick checks or when CI not needed
}
}

\subsection{Parallel Processing}{

Set \code{parallel = TRUE} to use multiple cores:
\itemize{
\item Automatically detects available cores
\item Falls back to sequential if parallel fails
\item Seed handling ensures reproducibility
}
}

\subsection{Reproducibility}{

Always set a seed for reproducible results:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{bootstrap_mediation(..., seed = 12345)
}\if{html}{\out{</div>}}
}

\subsection{Bootstrap Methods}{

\strong{Parametric Bootstrap} (\code{method = "parametric"}):
\itemize{
\item Samples parameter vectors from \eqn{N(\hat{\theta}, \hat{\Sigma})}{N(theta-hat, Sigma-hat)}
\item Fast and efficient
\item Assumes asymptotic normality of parameters
\item Recommended for most applications with n > 50
\item Requires \code{mediation_data} argument
}

\strong{Nonparametric Bootstrap} (\code{method = "nonparametric"}):
\itemize{
\item Resamples observations with replacement
\item Refits models for each bootstrap sample
\item More robust, no normality assumption
\item Computationally intensive
\item Use when normality is questionable or n is small
\item Requires \code{data} argument
}

\strong{Plugin Estimator} (\code{method = "plugin"}):
\itemize{
\item Computes point estimate only
\item No confidence interval
\item Fastest method
\item Use for quick checks or when CI not needed
\item Requires \code{mediation_data} argument
}
}

\subsection{Statistic Function}{

The \code{statistic_fn} should be a function that:
\itemize{
\item For parametric/plugin: Takes a named numeric vector of parameters
\item For nonparametric: Takes a data frame
\item Returns a single numeric value
}

Common statistic functions for indirect effect:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{# Using parameter names from MediationData
indirect_fn <- function(theta) \{
  theta["m_X"] * theta["y_M"]
\}
}\if{html}{\out{</div>}}
}

\subsection{Parallel Processing}{

Set \code{parallel = TRUE} to use multiple cores:
\itemize{
\item Uses \code{parallel::mclapply()} on Unix systems
\item Falls back to sequential on Windows
\item Automatically detects available cores
}
}

\subsection{Reproducibility}{

Always set a seed for reproducible results:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{bootstrap_mediation(..., seed = 12345)
}\if{html}{\out{</div>}}
}
}
\examples{
\dontrun{
# Parametric bootstrap for indirect effect
result <- bootstrap_mediation(
  statistic_fn = function(theta) theta["a"] * theta["b"],
  method = "parametric",
  mediation_data = med_data,
  n_boot = 5000,
  ci_level = 0.95,
  seed = 12345
)

# Nonparametric bootstrap with parallel processing
result <- bootstrap_mediation(
  statistic_fn = function(data) {
    # Refit models and compute statistic
    # ...
  },
  method = "nonparametric",
  data = mydata,
  n_boot = 5000,
  parallel = TRUE,
  seed = 12345
)

# Plugin estimator (no CI)
result <- bootstrap_mediation(
  statistic_fn = function(theta) theta["a"] * theta["b"],
  method = "plugin",
  mediation_data = med_data
)
}

# Generate example data
set.seed(123)
n <- 100
mydata <- data.frame(X = rnorm(n))
mydata$M <- 0.5 * mydata$X + rnorm(n)
mydata$Y <- 0.3 * mydata$X + 0.4 * mydata$M + rnorm(n)

# Fit mediation model
med_data <- fit_mediation(
  formula_y = Y ~ X + M,
  formula_m = M ~ X,
  data = mydata,
  treatment = "X",
  mediator = "M"
)

# Define indirect effect function
indirect_fn <- function(theta) theta["m_X"] * theta["y_M"]

# Plugin estimator (point estimate only, fastest)
result_plugin <- bootstrap_mediation(
  statistic_fn = indirect_fn,
  method = "plugin",
  mediation_data = med_data
)
print(result_plugin)

\donttest{
# Parametric bootstrap (recommended for most applications)
result <- bootstrap_mediation(
  statistic_fn = indirect_fn,
  method = "parametric",
  mediation_data = med_data,
  n_boot = 1000,
  ci_level = 0.95,
  seed = 12345
)
print(result)

# Nonparametric bootstrap (slower but more robust)
refit_fn <- function(boot_data) {
  fit_m <- lm(M ~ X, data = boot_data)
  fit_y <- lm(Y ~ X + M, data = boot_data)
  unname(coef(fit_m)["X"] * coef(fit_y)["M"])
}

result_np <- bootstrap_mediation(
  statistic_fn = refit_fn,
  method = "nonparametric",
  data = mydata,
  n_boot = 500,
  seed = 12345
)
print(result_np)
}

}
\seealso{
\link{BootstrapResult}, \link{MediationData}, \code{\link[=extract_mediation]{extract_mediation()}}

\link{BootstrapResult}, \link{MediationData}, \code{\link[=fit_mediation]{fit_mediation()}}
}
