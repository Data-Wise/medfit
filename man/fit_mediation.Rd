% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/aab-generics.R, R/fit-glm.R
\name{fit_mediation}
\alias{fit_mediation}
\title{Fit Mediation Models}
\usage{
fit_mediation(
  formula_y,
  formula_m,
  data,
  treatment,
  mediator,
  engine = "glm",
  family_y = stats::gaussian(),
  family_m = stats::gaussian(),
  ...
)

fit_mediation(
  formula_y,
  formula_m,
  data,
  treatment,
  mediator,
  engine = "glm",
  family_y = stats::gaussian(),
  family_m = stats::gaussian(),
  ...
)
}
\arguments{
\item{formula_y}{Formula for outcome model (e.g., \code{Y ~ X + M + C})}

\item{formula_m}{Formula for mediator model (e.g., \code{M ~ X + C})}

\item{data}{Data frame containing all variables}

\item{treatment}{Character string: name of treatment variable}

\item{mediator}{Character string: name of mediator variable}

\item{engine}{Character string: modeling engine to use. Currently supports:
\itemize{
\item \code{"glm"}: Generalized linear models (default)
}}

\item{family_y}{Family object for outcome model (default: \code{gaussian()})}

\item{family_m}{Family object for mediator model (default: \code{gaussian()})}

\item{...}{Additional arguments passed to the fitting function}
}
\value{
A \link{MediationData} object containing the fitted mediation structure

A \link{MediationData} object containing the fitted mediation structure
}
\description{
Fit mediation models using a specified modeling engine. This function
provides a convenient formula-based interface for fitting both the
mediator and outcome models simultaneously.

Fit mediation models using a specified modeling engine. This function
provides a convenient formula-based interface for fitting both the
mediator and outcome models simultaneously.
}
\details{
The \code{fit_mediation()} function fits both the mediator model and outcome
model using the specified engine, then extracts the mediation structure
using \code{\link[=extract_mediation]{extract_mediation()}}.
\subsection{Supported Engines}{

\strong{GLM} (\code{engine = "glm"}):
\itemize{
\item Fits models using \code{stats::glm()}
\item Supports all GLM families (gaussian, binomial, poisson, etc.)
\item For Gaussian models, extracts residual variances
}

\strong{Future Engines}:
\itemize{
\item \code{"lmer"}: Mixed-effects models via lme4
\item \code{"brms"}: Bayesian models via brms
}
}

\subsection{Model Specification}{

The formulas should follow standard R formula syntax:
\itemize{
\item \code{formula_m}: Mediator model (e.g., \code{M ~ X + C1 + C2})
\item \code{formula_y}: Outcome model (e.g., \code{Y ~ X + M + C1 + C2})
}

The mediator must appear in \code{formula_y}, and the treatment must appear
in both formulas.
}

\subsection{Model Specification}{

The function fits two models:
\enumerate{
\item \strong{Mediator model}: \code{formula_m} (e.g., \code{M ~ X + C1 + C2})
\item \strong{Outcome model}: \code{formula_y} (e.g., \code{Y ~ X + M + C1 + C2})
}

The treatment variable must appear in both formulas. The mediator variable
must appear in the outcome formula but NOT in the mediator formula (as it
is the response).
}

\subsection{GLM Engine}{

When \code{engine = "glm"} (default):
\itemize{
\item Models are fit using \code{\link[stats:glm]{stats::glm()}}
\item Supports all GLM families (gaussian, binomial, poisson, etc.)
\item For Gaussian models, residual standard deviations are extracted
\item Non-Gaussian outcomes have \code{sigma_y = NULL}
}
}

\subsection{Common Family Specifications}{

\itemize{
\item \code{gaussian()}: Continuous outcomes (default)
\item \code{binomial()}: Binary outcomes
\item \code{poisson()}: Count outcomes
\item \code{Gamma()}: Positive continuous outcomes
}
}
}
\examples{
\dontrun{
# Fit Gaussian mediation model
med_data <- fit_mediation(
  formula_y = Y ~ X + M + C,
  formula_m = M ~ X + C,
  data = mydata,
  treatment = "X",
  mediator = "M",
  engine = "glm"
)

# Fit with binary outcome
med_data <- fit_mediation(
  formula_y = Y ~ X + M + C,
  formula_m = M ~ X + C,
  data = mydata,
  treatment = "X",
  mediator = "M",
  engine = "glm",
  family_y = binomial()
)
}

# Generate example data
set.seed(123)
n <- 100
mydata <- data.frame(
  X = rnorm(n),
  C = rnorm(n)
)
mydata$M <- 0.5 * mydata$X + 0.2 * mydata$C + rnorm(n)
mydata$Y <- 0.3 * mydata$X + 0.4 * mydata$M + 0.1 * mydata$C + rnorm(n)

# Simple mediation with continuous variables
med_data <- fit_mediation(
  formula_y = Y ~ X + M,
  formula_m = M ~ X,
  data = mydata,
  treatment = "X",
  mediator = "M"
)
print(med_data)

# With covariates
med_data_cov <- fit_mediation(
  formula_y = Y ~ X + M + C,
  formula_m = M ~ X + C,
  data = mydata,
  treatment = "X",
  mediator = "M"
)

\donttest{
# Binary outcome (takes longer to fit)
mydata$Y_bin <- rbinom(n, 1, plogis(0.3 * mydata$X + 0.4 * mydata$M))
med_data_bin <- fit_mediation(
  formula_y = Y_bin ~ X + M,
  formula_m = M ~ X,
  data = mydata,
  treatment = "X",
  mediator = "M",
  family_y = binomial()
)
}

}
\seealso{
\link{MediationData}, \code{\link[=extract_mediation]{extract_mediation()}}, \code{\link[=bootstrap_mediation]{bootstrap_mediation()}}

\link{MediationData}, \code{\link[=extract_mediation]{extract_mediation()}}, \code{\link[=bootstrap_mediation]{bootstrap_mediation()}}
}
